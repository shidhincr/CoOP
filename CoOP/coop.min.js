/**
* Co-op Desktop notification - Google chrome extension
* @Author Shidhin C R
* @Version 1.0.0
* Requires prototype.js library
*/
var _$main$=function(){var a=document.createElement("a");a.innerHTML="Enable desktop notifications";a.id="_$link$_";a.href="#";var b=document.createTextNode(" |        ");var c=document.getElementById("controls");if(!c){return}c.insertBefore(b,c.firstChild);c.insertBefore(a,c.firstChild);if(window.webkitNotifications.checkPermission()!=0){link.setAttribute("onClick","javascript:window.webkitNotifications.requestPermission(_$final$);return false;")}else{_$final$()}};function _$notify$(){if(unreadCount.pauseNotification==0){document.getElementById("_$link$_").innerHTML="Resume notifications";unreadCount.pauseNotification=1}else{document.getElementById("_$link$_").innerHTML="Pause notifications";unreadCount.pauseNotification=0}};function _$final$(){var d=window.unreadCount;var e=window.unreadCount.updateUnreadCount;d.notifiedIds=[];if(document.getElementById("_$link$_")){document.getElementById("_$link$_").innerHTML="Pause notifications";d.pauseNotification=0;document.getElementById("_$link$_").setAttribute("onClick","javascript:_$notify$()")}window.unreadCount.updateUnreadCount=function(){var c='';if(!d.pauseNotification&&($('note_'+d.mostRecentlyViewedId)||$('day_entry_'+d.mostRecentlyViewedId))){$$('.entry').each(function(a){c=this._getIdFromEntryElement(a);if(c==this.mostRecentlyViewedId){throw $break;}if(!this._current_user_entry(a)&&this.notifiedIds.indexOf(c)==-1){var b=$('note_'+c).select(".favicon img")[0].getAttribute("src"),_name=$('note_'+c).select(".user_name_text")[0].innerHTML,_content=$('note_'+c).select("#display_text_note_"+c)[0].innerHTML+'    ( '+$('note_'+c).select(".user_name .meta")[0].innerHTML+' )';var n=window.webkitNotifications.createNotification(b,_name,_content);n.show();this.notifiedIds.push(c)}}.bind(d))}e.apply(this,arguments)}}if(!document.xmlVersion){var addScript=document.createElement('script');addScript.setAttribute("type","text/javascript");addScript.setAttribute("charset","UTF-8");addScript.appendChild(document.createTextNode('('+_$main$+')();'));addScript.appendChild(document.createTextNode(_$notify$));addScript.appendChild(document.createTextNode(_$final$));var h=document.getElementsByTagName("head")[0]||document.body||document.documentElement;h.appendChild(addScript)}